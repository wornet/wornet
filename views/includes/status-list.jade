.status-block(ng-repeat="status in recentStatus" data-id="{{ status._id }}" ng-if="(status.images && status.images.length) || (status.links && status.links.length) || (status.videos && status.videos.length) || (status.content && status.content.length)")
	//- .nostyle(data-starpush="{{ status._id }}")
	.aside.settings.continue(ng-if="status.author.hashedId")
		a.dropdown-toggle(data-toggle="dropdown")
			+glyph('cog')
		ul.dropdown-menu(role="menu")
			li(ng-if="status.concernMe")
				a.ajax(ng-click="delete(status, $event)" data-toggle="tooltip" data-placement="top" title=s("Supprimer ce contenu"))
					+glyph('trash')
					| &nbsp; 
					=s("Supprimer")
			li(ng-if="! status.reported")
				a.ajax(href="/report/{{ status._id }}" ng-click="report(status, $event)" data-toggle="tooltip" data-placement="top" title=s("Signaler ce contenu comme inapproprié"))
					+glyph('exclamation-sign')
					| &nbsp; 
					=s("Signaler")
		.alert.alert-success(ng-if="status.reported")
			=s("Une alerte a été envoyée aux modérateurs de Wornet. Merci pour votre aide.")
	.aside.continue.settings(ng-if="! status.author.hashedId")
		a.dropdown-toggle(data-toggle="dropdown")
			+glyph('cog')
		ul.dropdown-menu(role="menu")
			li: a.ajax(ng-click="delete(status, $event)" data-toggle="tooltip" data-placement="top" title=s("Supprimer ce contenu"))
				+glyph('trash')
				| &nbsp; 
				=s("Supprimer")
	.status-author
		img(ng-src="{{ status.author.thumb50 }}" data-user-thumb="{{ status.author.hashedId }}" data-thumb-size="50")
		+link("/user/profile/{{ status.author.hashedId }}/{{ status.author.name.full | urlencode }}", "{{ status.author.name.full }}")(ng-if="status.author.hashedId")
		a(ng-if="! status.author.hashedId") {{ status.author.name.full }}
		span(ng-if="status.at")
			+glyph('chevron-right')
			img(ng-src="{{ status.at.thumb50 }}" data-user-thumb="{{ status.at.hashedId }}" data-thumb-size="50")
			+link("/user/profile/{{ status.at.hashedId }}/{{ status.at.name.full | urlencode }}", "{{ status.at.name.full }}")
	.date(data-date="{{ status.date }}" ng-if="status.author.hashedId")
		|&nbsp;
	.status-content
		.alert.alert-info.glued(ng-if="status.status === 'blocked'")
			=s("Ce contenu a été bloqué.")
	.status-content.word-wrap(ng-if="status.content && status.content.length && status.status !== 'blocked'" ng-bind-html="status.content")
	.medias(ng-if="status.status !== 'blocked' && (status.images.length > 0 || status.videos.length > 0 || status.links.length > 0)")
		div(ng-if="status.images.length > 0")
			h3(ng-if="status.album")
				a.album-name(href="/user/album/{{ status.album }}")
					+glyph('folder-open')
					|&nbsp; {{ status.albumName }}
			h3(ng-if="! status.album")
				=s("Images")
			a(ng-repeat="image in status.images | orderBy: '-src'" data-toggle="modal" data-target="#media-viewer" ng-click="loadMedia('image', image)")
				img(ng-src="{{ image.src }}" alt="{{ image.name }}")
		div(ng-if="status.videos.length > 0")
			h3=s("Vidéos")
			div(ng-repeat="video in status.videos")
				iframe.preview(ng-if="displayPlayer" ng-src="{{ video.href }}" frameborder="0" allowfullscreen)
				a(ng-if="displayPlayer" data-toggle="modal" data-target="#status-view" ng-click="loadMedia('video', video)")
					=s("Plus")
				a.mobile-video(ng-if="! displayPlayer" data-toggle="modal" data-target="#status-view" ng-click="loadMedia('video', video)")
					img.video-preview(ng-src="{{ thumbnail(video.href) }}" width="240" height="180")
					+glyph('play')
		div(ng-if="status.links.length > 0")
			h3=s("Liens")
			a(ng-repeat="link in status.links" target="_blank" href="{{ link.https ? 'https' : 'http' }}://{{ link.href }}") {{ link.href.substr(0, 34) + (link.href.length > 34 ? '...': '') }}
	.cb
	div(ng-if="status._id !== '" + StatusPackage.DEFAULT_STATUS_ID + "'")
		if config.wornet.comments.enabled || config.wornet.plusW.enabled
			.status-actions
				if config.wornet.plusW.enabled
					span.btn.btn-action-plus-w(ng-class="{ full: status.likedByMe }" ng-click="toggleLike(status)")
					span.like-zone
						| {{ nbLikeText(status) }}
				if config.wornet.comments.enabled
					span.btn-action-comment(ng-click="showCommentBlock(status)")
						span.btn.icon
						span(ng-if="nbCommentLoaded")
							| {{ nbCommentText(status) }}
			.cb
		if config.wornet.comments.enabled
			.comment-list(ng-if="status.comments && status.comments.length && status.commentList")
				.comment-block(ng-repeat="comment in status.comments" data-data="{{ comment._id }}")
					- var init = "comment.edit = false;"
					- init += "comment.originalContent = comment.content;"
					.aside.settings.continue(ng-init=init ng-if="comment.author.hashedId && (comment.isMine || comment.onMyWall)")
						a.dropdown-toggle(data-toggle="dropdown")
							+glyph('cog')
						ul.dropdown-menu(role="menu")
							li(ng-if="comment.isMine")
								a.ajax(non-block-click="comment.edit = true;" data-toggle="tooltip" data-placement="top" title=s("Modifier ce commentaire"))
									+glyph('pencil')
									| &nbsp; 
									=s("Modifier")
							li(ng-if="comment.isMine || comment.onMyWall")
								a.ajax(ng-click="deleteComment(comment)" data-toggle="tooltip" data-placement="top" title=s("Supprimer ce commentaire"))
									+glyph('trash')
									| &nbsp; 
									=s("Supprimer")
					.comment-author
						img(ng-src="{{ comment.author.thumb50 }}" data-user-thumb="{{ comment.author.hashedId }}" data-thumb-size="50")
						+link("/user/profile/{{ comment.author.hashedId }}/{{ comment.author.name.full | urlencode }}", "{{ comment.author.name.full }}")
					.date(data-date="{{ comment.date }}")
						|&nbsp;
					.comment-content.word-wrap(ng-if="comment.content && comment.content.length && comment.status !== 'blocked' && !comment.edit" ng-bind-html="comment.content | smilies")
					.comment-edit(ng-if="comment.edit")
						+form()(ng-submit="comment.edit = false; updateComment(comment); comment.originalContent = comment.content;").cb
							textarea.form-control(focus ng-model='comment.content' placeholder=s("Commentaire..."))
							input.btn.col-xs-12.col-sm-6.fit.cancel(type="button" ng-click="comment.content = comment.originalContent; comment.edit = false" value=s("Annuler"))
							input.btn.col-xs-12.col-sm-6.fit.btn-primary(type="submit" value=s("Envoyer"))
					.cb
			.comment-form(ng-if="status.commentForm")
				+form()(ng-submit="sendComment(status)").cb
					textarea.form-control(focus ng-model='status.newComment.content' placeholder=s("Ajouter un commentaire..."))
					input.btn.btn-primary(type="submit" value=s("Envoyer"))
					input.btn.cancel(type="button" ng-click="status.commentForm = false; status.commentList = false" value=s("Annuler"))

div(scroll-detect verify-to-load="statusRemaining()" gap="300" url="getLoadUrl()" offset="getStatusOffset()" callback="loadStatusList").status-loading
+data('statusPageCount', config.wornet.limits.statusPageCount)

if config.wornet.comments.enabled
	+data('commentsEnabled', true)
